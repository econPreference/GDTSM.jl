<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Estimation · TermStructureModels.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TermStructureModels.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../notations/">Notations</a></li><li class="is-active"><a class="tocitem" href>Estimation</a><ul class="internal"><li><a class="tocitem" href="#Step-1.-Tuning-Hyperparameters"><span>Step 1. Tuning Hyperparameters</span></a></li><li><a class="tocitem" href="#Step-2.-Sampling-the-Posterior-Distribution-of-Parameters"><span>Step 2. Sampling the Posterior Distribution of Parameters</span></a></li><li><a class="tocitem" href="#Diagnostics-for-MCMC"><span>Diagnostics for MCMC</span></a></li></ul></li><li><a class="tocitem" href="../inference/">Inference</a></li><li><a class="tocitem" href="../scenario/">Forecasting</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/econPreference/TermStructureModels.jl/blob/main/docs/src/estimation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Step-1.-Tuning-Hyperparameters"><a class="docs-heading-anchor" href="#Step-1.-Tuning-Hyperparameters">Step 1. Tuning Hyperparameters</a><a id="Step-1.-Tuning-Hyperparameters-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1.-Tuning-Hyperparameters" title="Permalink"></a></h2><p>We have five hyperparameters, <code>p</code>, <code>q</code>, <code>nu0</code>, <code>Omega0</code>, and <code>mean_phi_const</code>.</p><ul><li><code>p::Float64</code>: lag length of the <span>$\mathbb{P}$</span>-VAR(p)</li><li><code>q::Matrix{Float64}( , 4, 2)</code>: Shrinkage degrees in the Minnesota prior</li><li><code>nu0::Float64</code>(d.f.) and <code>Omega0::Vector</code>(scale matrix): Prior distribution of the error covariance matrix in the <span>$\mathbb{P}$</span>-VAR(p)</li><li><code>mean_phi_const</code>: Prior mean of the intercept term in the <span>$\mathbb{P}$</span>-VAR(p)</li></ul><p>We recommend <a href="../api/#TermStructureModels.tuning_hyperparameter-NTuple{4, Any}"><code>tuning_hyperparameter</code></a> for deciding the hyperparameters.</p><pre><code class="language-julia hljs">tuned, results = tuning_hyperparameter(yields, macros, tau_n, rho; populationsize=50, maxiter=10_000, medium_tau=collect(24:3:48), upper_q=[1 1; 1 1; 10 10; 100 100], mean_kQ_infty=0, std_kQ_infty=0.1, upper_nu0=[], mean_phi_const=[], fix_const_PC1=false, upper_p=18, mean_phi_const_PC1=[], data_scale=1200, medium_tau_pr=[], init_nu0=[])</code></pre><p>Note that the default upper bound of <code>p</code> is <code>upper_p=18</code>. <code>tuned::Hyperparameter</code> is the one we need for the estimation.</p><p>If users accept our default values, the function simplifies, that is</p><pre><code class="language-julia hljs">tuned, results = tuning_hyperparameter(yields, macros, tau_n, rho)</code></pre><p><code>yields</code> is a <code>T</code> by <code>N</code> matrix, and <code>T</code> is the length of the time period. <code>N</code> is the number of maturities in data. <code>tau_n</code> is a <code>N</code>-Vector that contains maturities in data. For example, if there are two maturities, 3 and 24 months, in a monthly term structure model, <code>tau_n=[3; 24]</code>. <code>macros</code> is a <code>T</code> by <code>dP-dQ</code> matrix in which each column is an individual macroeconomic variable. <code>rho</code> is a <code>dP-dQ</code>-Vector. In general, the i-th entry in <code>rho</code> is <code>1</code> if i-th macro variable is in level, or it is set to 0 if the variable is differenced.</p><div class="admonition is-info"><header class="admonition-header">Computational length of the optimization</header><div class="admonition-body"><p>Since we adopt the Differential Evolutionary algorithm, it is hard to set the terminal condition. Our strategy was &quot;Run the algorithm with sufficient <code>maxiter</code>(our defaults), and verify that it is an global optimum by plotting the objective function&quot;. It is appropriate for academic projects.</p><p>However, it is not good for practical projects. Small <code>populationsize</code> or <code>maxiter</code> may not lead to the best model, but it will find a good model. The prior distribution does not need to be the best form. Set <code>maxiter</code> based on your computational resources.</p></div></div><h2 id="Step-2.-Sampling-the-Posterior-Distribution-of-Parameters"><a class="docs-heading-anchor" href="#Step-2.-Sampling-the-Posterior-Distribution-of-Parameters">Step 2. Sampling the Posterior Distribution of Parameters</a><a id="Step-2.-Sampling-the-Posterior-Distribution-of-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2.-Sampling-the-Posterior-Distribution-of-Parameters" title="Permalink"></a></h2><p>In Step 1, we got <code>tuned::Hyperparameter</code>. <a href="../api/#TermStructureModels.posterior_sampler-Tuple{Any, Any, Any, Any, Any, Hyperparameter}"><code>posterior_sampler</code></a> uses it for the estimation.</p><pre><code class="language-julia hljs">saved_params, acceptPrMH = posterior_sampler(yields, macros, tau_n, rho, iteration, tuned::Hyperparameter; medium_tau=collect(24:3:48), init_param=[], ψ=[], ψ0=[], gamma_bar=[], medium_tau_pr=[], mean_kQ_infty=0, std_kQ_infty=0.1, fix_const_PC1=false, data_scale=1200)</code></pre><p>If users changed the default values in Step 1, the corresponding default values in the above function also should be changed. If users use our defaults, the function simplifies to</p><pre><code class="language-julia hljs">saved_params, acceptPrMH = posterior_sampler(yields, macros, tau_n, rho, iteration, tuned::Hyperparameter)</code></pre><p><code>iteration</code> is the number of posterior samples that users want to get. Our MCMC starts at the prior mean, and you have to erase burn-in samples manually.</p><p>Output <code>saved_params</code> is a Vector that has a length of <code>iteration</code>. Each entry is struct <code>Parameter</code>. <code>acceptPrMH</code> is dQ-Vector, and i-th entry shows the HM acceptance rate for i-th principal component in the recursive <span>$\mathbb{P}$</span>-VAR.</p><h2 id="Diagnostics-for-MCMC"><a class="docs-heading-anchor" href="#Diagnostics-for-MCMC">Diagnostics for MCMC</a><a id="Diagnostics-for-MCMC-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics-for-MCMC" title="Permalink"></a></h2><p>We believe in the efficiency of our algorithm, so users do not need to be overly concerned about the convergence of the posterior samples. In our opinion, sampling 6,000 posterior samples and erase the first 1,000 samples as burn-in would be enough.</p><p>We provide <a href="@ref">a measure</a> to gauge the efficiency of the algorithm, that is</p><pre><code class="language-julia hljs">ineff = ineff_factor(saved_params)</code></pre><p><code>saved_params::Vector{Parameter}</code> is the output of <code>posterior_sampler</code>. <code>ineff</code> is <code>Tuple(kappaQ, kQ_infty, gamma, SigmaO, varFF, phi)</code>. Each object in the tuple has the same shape as its corresponding parameter. If an inefficiency factor is high, it indicates poor sampling efficiency for the parameter located at the same position.</p><p>You can calculate the maximum inefficiency factor by</p><pre><code class="language-julia hljs">max_ineff = (ineff[1], ineff[2], ineff[3] |&gt; maximum, ineff[4] |&gt; maximum, ineff[5] |&gt; maximum, ineff[6] |&gt; maximum) |&gt; maximum</code></pre><p>Dividing the total number of posterior samples by <code>max_ineff</code> allows for the calculation of the effective number of posterior samples, taking into account the efficiency of the sampler. For example, let&#39;s say <code>max_ineff = 10</code>. Then, if 6,000 posterior samples are drawn and the first 1,000 samples are erased as burn-in, the remaining 5,000 posterior samples have the same efficiency as using 500 i.i.d samples, calculated as <code>(6000-1000)/max_ineff</code>. For reference, in <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4708628">our paper</a>, the maximum inefficiency factor was <code>2.38</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../notations/">« Notations</a><a class="docs-footer-nextpage" href="../inference/">Inference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 5 February 2024 10:08">Monday 5 February 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
